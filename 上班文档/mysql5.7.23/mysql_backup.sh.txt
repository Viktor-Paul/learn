# Name:mysql_backup.sh
# author:qsk
# This is a ShellScript For Auto DB Backup and Delete old Backup

#备份地址
backupdir=/file/mysql/backup/
#备份文件后缀时间
time=_` date +%Y_%m_%d_%H_%M_%S `
#需要备份的数据库名称
db_name=web_contacts
#mysql 用户M
db_user=root
#mysql 密码
db_pass=Suntek!WC123
#判断数据库备份路径是否存在
ls $backupdir
if [ $? -ne 0 ]
then
        mkdir -p $backupdir
fi
#mysqldump命令使用绝对路径
/usr/local/mysql/bin/mysqldump -u$db_user -p$db_pass $db_name | gzip -9 > $backupdir/$db_name$time.sql.gz
#复制到app2服务器上
/usr/bin/scp -P 23456 /file/mysql/backup/$db_name$time.sql.gz root@192.168.10.22:/file/mysql/backup
#删除7天之前的备份文件
find $backupdir -name $db_name"*.sql.gz" -type f -mtime +7 |xargs rm -rf > /dev/null 2>&1

